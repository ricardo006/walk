sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,o,n,i){"use strict";return e.extend("ui5.walkthrough.controller.InvoiceList",{onInit(){if(window.localStorage){var e=window.localStorage.getItem("invoiceData");if(e){var t=JSON.parse(e);var n=new o(t);this.getView().setModel(n,"invoiceData")}else{this.loadDataFromAPI()}}},loadDataFromAPI:function(){var e=new o("https://jsonplaceholder.typicode.com/todos");e.attachRequestCompleted(function(){var t=e.getProperty("/");var n=t.map(function(e){return e}).sort(function(e,t){return e.id-t.id});window.localStorage.setItem("invoiceData",JSON.stringify(n));var i=new o(n);this.getView().setModel(i,"invoiceData");console.log("Dados ordenados pelo ID:",n)}.bind(this))},restoreStatusLocally:function(){if(window.localStorage){var e=window.localStorage.getItem("invoiceData");var t=e?JSON.parse(e):{};console.log("Dados armazenados no Local Storage:",t);var o=this.getView().getModel("invoiceData");var n=o.getProperty("/");for(var i in t){if(t.hasOwnProperty(i)){var a=n.find(function(e){return e.id.toString()===i});if(a){a.completed=t[i]}}}o.setProperty("/",n)}},sortDataById:function(){var e=this.getView().getModel("invoice");var t=e.getProperty("/");t.sort(function(e,t){return e.id-t.id});e.setProperty("/",t);console.log("Dados ordenados pelo ID:",t)},onFilterInvoices(e){const t=[];const o=e.getParameter("query");if(o){t.push(new n("title",i.Contains,o))}const a=this.byId("invoiceList");const r=a.getBinding("items");r.filter(t)},onPress(e){const t=e.getSource();const o=t.getBindingContext("invoiceData");if(o){const e=o.getProperty("id");const t=this.getOwnerComponent().getRouter();t.navTo("detail",{invoicePath:window.encodeURIComponent(o.getPath().substr(1)),invoiceId:e})}else{console.error("O contexto de ligação ('binding context') não está disponível.")}},onShowDetails:function(e){const t=e.getSource();const o=t.getBindingContext("invoiceData");if(o){const e=o.getProperty("id");const t=window.localStorage.getItem("invoiceStatus");const n=t?JSON.parse(t):{};const i=o.getPath();const a=n[i]!==undefined?n[i]:o.getProperty("completed");const r=this.getOwnerComponent().getRouter();r.navTo("detail",{invoicePath:window.encodeURIComponent(i.substr(1)),invoiceId:e,completedStatus:a})}else{console.error("O contexto de ligação ('binding context') não está disponível.")}},onToggleCompleted:function(e){var o=e.getSource();var n=this.getView().getModel("invoiceData");var i=o.getBindingContext("invoiceData");var a=i.getPath();var r=n.getProperty(a+"/completed");var s=n.getProperty(a+"/id");n.setProperty(a+"/completed",!r);this.updateLocalStorage(s,{completed:!r});t.show("Status do registo #"+s+" alterado para "+(!r===true?"Completo!":"Incompleto!"))},updateLocalStorage:function(e,t){var o=localStorage.getItem("invoiceData");var n=JSON.parse(o);for(var i=0;i<n.length;i++){if(n[i].id===e){n[i].completed=t.completed;localStorage.setItem("invoiceData",JSON.stringify(n));console.log("Elemento Após a Alteração no Local Storage:",n[i]);break}}}})});
//# sourceMappingURL=InvoiceList.controller.js.map